---
layout: post
title: '카프카를 한번 구축해보자'
categories: kafka
comments: false
---

지금부터 카프카를 구축해 보면서 카프카에 대한 좀 더 자세한 내용을 알아보겠습니다. 카프카를 설치하기 위해서는 주키퍼라는 것에 대해 먼저 알아야 합니다.  

### 주키퍼(Zookeeper)
카프카를 설치할 때는 주키퍼도 같이 설치해주어야 합니다. 주키퍼란 분산 애플리케이션 관리를 위해 만들어진 코디네이션 시스템입니다. 자체적으로 분산 관리를 위한 기능을 구현하기에는 많은 개발 리소스가 들기 때문에 카프카에서는 안정적인 서비스가 검증이 된 주키퍼를 사용하고 있습니다. 실제 카프카를 비롯하여 에이치베이스나 스톰 등 여타 다른 애플리케이션에서 분산관리를 위해 주키퍼를 믾이 활용하고 있다고 합니다. 

주키퍼가 하는 일은 여러 대의 호스트에 분리되어 설치된 카프카의 설정관리, 클러스터 관리, 동기화 등에 대한 처리입니다. 


![주키퍼](/assets/img/kafka/kafka-02.PNG){: width="600" height="400"}

주키퍼는 서버 여러대로 구성된 앙상블이라고 하는 클러스터로 이루어져 있습니다. 앙상블 내의 각 서버들은 분산된 애플리케이션 클라이언트와 각각 컨넥션을 맺고 데이터를 주고 받게 됩니다. 클라이언트로부터 데이터를 전달 받은 서버는 이를 지노드(znode)라고 불리는 곳에 키-값 형태로 저장하게 됩니다. 그리고 리더 서버에 이 정보를 전달하게 되고, 리더 서버는 이를 전체 서버에 브로드캐스트하는 방식으로 전체 데이터의 일관성을 유지합니다.

주키퍼는 일반적으로 홀수 단위의 서버 수로 앙상블을 구성하게 되는데, 과반수 방식으로 서비스의 지속여부를 결정하기 때문입니다. 만약 앙상블을 3대의 서버로 구성했는데 그 중 하나가 다운될 시, 2개의 서버가 살아있기 때문에 서비스는 지속할 수 있습니다. 하지만 2개의 서버가 다운되게 되면 남아있는 서버는 1개가 되므로 과반수 방식에 따라 서비스는 지속할 수 없게 됩니다. 

주키퍼에 대해 기본적인 내용을 알아봤으므로 이젠 설치를 진행해 보도록 하겠습니다.

### 주키퍼 설치
(작성 중..)



### 참고자료
- [https://engkimbs.tistory.com/660](https://engkimbs.tistory.com/660)
- 카프카, 데이터 플랫폼의 최강자[고승범/공용준 지음, 책만]